<section>

    <header class="clearfix row">
        <h1 class="pull-left col-sm-8">Reports</h1>
    </header>

    <hr>
    <br>

    <div ng-hide="isLoading">

        <uib-tabset>

            <uib-tab heading="Income per month">
                <section>
                    <br><br>
                    <h2>Income per month</h2>
                    <br>

                    <div ng-show="!isLoading && months.length">

                        <canvas height="70" id="line" class="chart chart-line"
                            ng-show="months.length > 1"
                            chart-data="chartMonth.data"
                            chart-labels="chartMonth.labels"
                            chart-series="chartMonth.series"
                            chart-legend="true">
                        </canvas>

                        <table class="table table-hover table-tpm">
                            <thead>
                                <tr>
                                    <th class="text-uppercase">Month</th>
                                    <th width="160" class="text-uppercase">Projects</th>
                                    <th width="160" class="text-uppercase">Income</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="month in months">
                                    <td>
                                        <strong>{{month.month}}</strong>
                                    </td>
                                    <td>
                                        <a href="" ng-click="showProjects('Projects from ' + month.month, month.projects)">{{month.projects.length}} projects</a>
                                    </td>
                                    <td>
                                        {{month.price}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <p class="text-danger"><b>NOTE:</b> projects are always included on the month in which they were <b>Paid</b>.</p>
                        <h4 ng-if="notPaid > 0"><span class="label label-danger">Projects "finished", but not "paid": {{ notPaid }}</span></h4>
                    </div>

                    <p class="alert alert-warning text-center" ng-show="!isLoading && !months.length">
                        Currently, there are no Reports to display. You need to have "Paid" projects in order to display Reports.
                    </p>
                </section>
            </uib-tab>

            <uib-tab heading="Price evolution per project">
                <section>
                    <br><br>
                    <h2>Price evolution per project</h2>
                    <br>
                    
                    <div ng-show="!isLoading && chartPrice.data.length">
                        <p><b>NOTE:</b> Projects that have either the <b>Estimated</b> or <b>Final</b> price not set (or set to "0") are considered <b>"Not Changed"</b>.</p>
                        <br>
                        <canvas id="doughnut" class="chart chart-doughnut" height="80"
                            chart-data="chartPrice.data"
                            chart-labels="chartPrice.labels"
                            chart-click="showProjectsByPriceChange">
                        </canvas>
                    </div>

                    <p class="alert alert-warning text-center" ng-show="!isLoading && !chartPrice.data.length">
                        Currently, there are no Reports to display. You need to have "Paid" projects in order to display Reports.
                    </p>
                </section>
            </uib-tab>

            <uib-tab heading="Most income per client">
                <section>
                    <br><br>
                    <h2>Most income per client</h2>
                    <br>
                    <table class="table table-hover table-tpm" ng-show="!isLoading && clientsByPrice.length">
                        <thead>
                            <tr>
                                <th class="text-uppercase">Client</th>
                                <th width="160" class="text-uppercase">Projects</th>
                                <th width="160" class="text-uppercase">Income</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="client in clientsByPrice | limitTo: 10">
                                <td>
                                    <strong>{{client.name}}</strong>
                                </td>
                                <td>
                                    <a href="" ng-click="showProjects('Projects from ' + client.name, client.projects)">{{client.projects.length}} projects</a>
                                </td>
                                <td>
                                    {{client.price}}
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <p class="alert alert-warning text-center" ng-show="!isLoading && !clientsByPrice.length">
                        Currently, there are no Reports to display. You need to have "Paid" projects in order to display Reports.
                    </p>
                </section>
            </uib-tab>

            <uib-tab heading="Most projects per client">
                <section>
                    <br><br>
                    <h2>Most projects per client</h2>
                    <br>
                    <table class="table table-hover table-tpm" ng-show="!isLoading && clientsByProjects.length">
                        <thead>
                            <tr>
                                <th class="text-uppercase">Client</th>
                                <th width="160" class="text-uppercase">Projects</th>
                                <th width="160" class="text-uppercase">Income</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="client in clientsByProjects | limitTo: 10">
                                <td>
                                    <strong>{{client.name}}</strong>
                                </td>
                                <td>
                                    <a href="" ng-click="showProjects('Projects from ' + client.name, client.projects)">{{client.projects.length}} projects</a>
                                </td>
                                <td>
                                    {{client.price}}
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <p class="alert alert-warning text-center" ng-show="!isLoading && !clientsByProjects.length">
                        Currently, there are no Reports to display. You need to have "Paid" projects in order to display Reports.
                    </p>
                </section>
            </uib-tab>

        </uib-tabset>

    </div>

</section>
